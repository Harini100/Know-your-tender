<!DOCTYPE html>

<html lang="en">

<head>

<!------ Include the above in your HEAD tag ---------->


<!------ Include the above in your HEAD tag ---------->
    <link href="https://fonts.googleapis.com/css?family=Oleo+Script:400,700" rel="stylesheet">
   	<link href="https://fonts.googleapis.com/css?family=Teko:400,700" rel="stylesheet">
   	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
   	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <style media="screen" type="text/css">

        ul li {

            display: inline;

        }
		
		.content-header{
  font-family: 'Oleo Script', cursive;
  color:#fcc500;
  font-size: 45px;
}

.section-content{
  text-align: center; 

}

.contact-section{
  padding-top: 40px;
}
.contact-section .col-md-6{
  width: 50%;
}


    </style>

    <title>Tender Details</title>



    <meta charset="utf-8">



    <meta name="viewport" content="width=device-width, initial-scale=1">



    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css">
	
	




    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>



    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>



    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>

</head>

<body>

    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

    <div class="container" ng-app="app" ng-controller="myCtrl">

        <!-- <select ng-model="selectedName" ng-options="x for x in names"></select> -->

        <!--<h2>Tender Details</h2>-->
		
		<section id="contact">
			<div class="section-content">
				<h1 class="section-header"> <span class="content-header wow fadeIn " data-wow-delay="0.2s" data-wow-duration="2s">Know Your Tender</span></h1>
				<h3 style="font-family: 'Teko', sans-serif">Please enter the following fields</h3><br>
			</div>







            <form name="form1" class="form-inline" role="form">




                <div class="col-md-4" style="text-align: center">
                    <label>

                        STATE:&nbsp   <select name="state" class="form-control mb-2 mr-sm-2" id="state" ng-model="statename" onchange="loadCities()" required>



                            <option disabled selected value>select state</option>
                            <option>Karnataka</option>


                        </select>

                    </label>
                </div>


                <div class="col-md-4" style="text-align: center">
                    <label>

                        CITY:&nbsp   <select name="city" class="form-control mb-2 mr-sm-2" id="city" ng-model="cityname" onchange="loadAreas()" required>



                            <option disabled selected value>select city</option>



                        </select>

                    </label>
                </div>


                <div class="col-md-4" style="text-align: center">
                    <label>

                        AREA:&nbsp   <select name="area" class="form-control mb-2 mr-sm-2" id="area" ng-model="areaname" required>



                            <option disabled selected value>select area</option>



                        </select>

                    </label>
                </div>


                <div class="col-md-6" style="text-align: center">
                    <label>
                        FROM:&nbsp <input type="date" name="fromdate" id="fromdate" class="form-control mb-2 mr-sm-2" ng-model="fromdate" onchange="dateChecker()" required/>
                    </label>

                </div>

                <div class="col-md-6" style="text-align: center">
                    <label>
                        TO:&nbsp <input type="date" name="todate" id="todate" class="form-control mb-2 mr-sm-2" ng-model="todate" onchange="dateChecker()" required/>
                    </label>

                </div>



                <br>
                <div class="col-md-12" style="text-align: center">
                    <button type="submit" class="btn btn-primary mb-2" ng-click="form1.$valid && SendData()">Submit</button>
                </div>


            </form>


        <hr/> {{PostDataResponse.dataArray}}
        <!--  <p>CITY: <input type="text" ng-model="cityname" required /></p>

          <p>AREA: <input type="text" ng-model="areaname" required /></p>

          <p>TENDER TYPE: <input type="text"  ng-model="tendertype" required /></p>

          <button ng-click="SendData()">Submit</button> -->
		  
		  
		          <h4 ng-repeat="tender in PostDataResponse.dataArray">

            <div class="card">



                <div class="card-body">



                    <h4 class="card-text">{{tender.locality}}</h4>
					
					<h4 class="card-text">{{tender.docType}}</h4>
					
					<h4 class="card-text">{{tender.publishedTime}}</h4>

					<h6 ng-repeat="link in tender.linkOfTheDocs">



                        <a href={{link}} class="card-link">Link{{$index + 1}}</a>



                    </h6>

                   
					

                </div>



            </div> 

        <br /><br />









            <br />



    </div>







    <script>

        function dateChecker() {
            if (document.getElementById("fromdate").value != "" && document.getElementById("todate").value != "") {
                if (document.getElementById("todate").value < document.getElementById("fromdate").value) {
                    alert("To date must not be lesser than from date.");
                    document.getElementById("todate").value = "";
                }
            }
        }

        function loadCities() {            

            var url = "cities.json";

            var y = document.getElementById("city");

            $.getJSON(url, function (json) {

                for (var i = 0; i < json.length; i++) {

                    var option = document.createElement("option");

                    option.text = json[i].city;

                    y.add(option);

                }

            });

        }



        function loadAreas() {

            var x = document.getElementById("area");

            var y = document.getElementById("city");

            while (x.length > 1) {

                x.remove(1);

            }

            var url = "areas.json";

            $.getJSON(url, function (json) {

                for (var i = 0; i < json.length; i++) {

                    if (json[i].city == y.value) {

                        var option = document.createElement("option");

                        option.text = json[i].area;

                        x.add(option);

                    }

                }

            });

        }



        var app = angular.module("app",[]);

        app.controller("myCtrl", function($scope,$http){

		

        $scope.SendData = function() {



            var data = {

                   cName : $scope.cityname,

				  aName : $scope.areaname,

				  fdate : $scope.fromdate,
				  
				  tdate : $scope.todate

                }

            $http.post('/post', data)

                .success(function (data, status, headers, config) {

                    $scope.PostDataResponse = data;

					/*var m=data.map(JSON.stringify);

					for (var i=0;i<m.length;i++) {

			              var mj=JSON.parse(m[i]);

							alert(mj.name);

							for(var j=0;j<mj.Links.length;j++)

							   alert(mj.Links[j]);

						}*/

                })

                .error(function(data, status, header, config){

                    $scope.PostDataResponse = "Data: " + status;



                });

        };

        });

    </script>

</body>